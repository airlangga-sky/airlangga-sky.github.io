<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ular Tangga</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"></link>
    <style>
        .board {
            display: grid;
            grid-template-columns: repeat(10, 50px);
            grid-template-rows: repeat(10, 50px);
            gap: 1px;
            border: 2px solid #333;
        }
        .cell {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 10px;
            text-align: center;
            position: relative;
        }
        .red { background-color: #ffcccc; }
        .blue { background-color: #ccccff; }
        .yellow { background-color: #ffffcc; }
        .gray { background-color: #cccccc; }
        .ladder, .snake {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
        }
        .ladder {
            background-image: url('https://placehold.co/50x50?text=Ladder');
        }
        .snake {
            background-image: url('https://placehold.co/50x50?text=Snake');
        }
        .player {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #000;
            border-radius: 50%;
        }
        .player1 { background-color: #000; }
        .player2 { background-color: #ff0000; }
    </style>
</head>
<body class="flex flex-col items-center justify-center h-screen bg-gray-100">
    <div class="board hidden" id="board">
        <!-- Cells will be generated by JavaScript -->
    </div>
    <div class="mt-4" id="playerSelection">
        <button class="px-4 py-2 bg-blue-500 text-white rounded" onclick="startGame(1)">1 Player</button>
        <button class="px-4 py-2 bg-green-500 text-white rounded" onclick="startGame(2)">2 Players</button>
    </div>
    <button class="dice mt-4 px-4 py-2 bg-blue-500 text-white rounded hidden" id="rollDiceButton" onclick="rollDice()">Roll Dice</button>
    <div class="mt-2 text-lg" id="diceResult"></div>
    <script>
        const board = document.getElementById('board');
        const diceResult = document.getElementById('diceResult');
        const rollDiceButton = document.getElementById('rollDiceButton');
        const playerSelection = document.getElementById('playerSelection');
        const cells = [];
        const ladders = { 3: 22, 8: 30, 15: 44, 21: 42, 28: 76, 36: 54, 51: 67, 71: 92, 78: 98 };
        const snakes = { 16: 6, 47: 26, 49: 11, 56: 53, 62: 19, 64: 60, 87: 24, 93: 73, 95: 75, 99: 78 };
        let playerPositions = [0, 0];
        let isTrapped = [false, false];
        let isSnakeBitten = [false, false];
        let currentPlayer = 0;
        let numPlayers = 1;

        const colors = [
            'red', 'blue', 'yellow', 'gray', 'red', 'yellow', 'blue', 'red', 'yellow', 'blue',
            'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow',
            'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red',
            'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue',
            'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow',
            'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red',
            'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue',
            'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow',
            'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red', 'blue', 'yellow', 'red'
        ];

        function createBoard() {
            for (let i = 0; i < 100; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.classList.add(colors[i % colors.length]);
                cell.innerHTML = i + 1;
                if ((i + 1) % 4 === 0) {
                    cell.innerHTML += '<div class="trap">?</div>';
                } else {
                    if (ladders[i + 1]) {
                        const ladder = document.createElement('div');
                        ladder.classList.add('ladder');
                        cell.appendChild(ladder);
                    }
                    if (snakes[i + 1]) {
                        const snake = document.createElement('div');
                        snake.classList.add('snake');
                        cell.appendChild(snake);
                    }
                }
                board.appendChild(cell);
                cells.push(cell);
            }
        }

        function startGame(players) {
            numPlayers = players;
            playerSelection.classList.add('hidden');
            board.classList.remove('hidden');
            rollDiceButton.classList.remove('hidden');
            createBoard();
            updatePlayerPosition();
        }

        function rollDice() {
            if (isTrapped[currentPlayer]) {
                const [num1, num2] = [Math.floor(Math.random() * 900) + 100, Math.floor(Math.random() * 90) + 10];
                const answer = prompt(`Solve this to continue: ${num1} x ${num2} = ?`);
                if (parseInt(answer) === num1 * num2) {
                    isTrapped[currentPlayer] = false;
                } else {
                    alert('Wrong answer! You cannot move forward.');
                    return;
                }
            }
            if (isSnakeBitten[currentPlayer]) {
                playerPositions[currentPlayer] -= 1;
                isSnakeBitten[currentPlayer] = false;
                updatePlayerPosition();
                switchPlayer();
                return;
            }
            const diceRoll = Math.floor(Math.random() * 6) + 1;
            diceResult.textContent = `Player ${currentPlayer + 1} rolled a ${diceRoll}`;
            movePlayer(diceRoll);
        }

        function movePlayer(steps) {
            playerPositions[currentPlayer] += steps;
            if (playerPositions[currentPlayer] >= 100) {
                alert(`Player ${currentPlayer + 1} wins!`);
                playerPositions = [0, 0];
                currentPlayer = 0;
                updatePlayerPosition();
                return;
            }
            if (ladders[playerPositions[currentPlayer]]) {
                playerPositions[currentPlayer] = ladders[playerPositions[currentPlayer]];
            }
            if (snakes[playerPositions[currentPlayer]]) {
                playerPositions[currentPlayer] = snakes[playerPositions[currentPlayer]];
                isSnakeBitten[currentPlayer] = true;
            }
            updatePlayerPosition();
            if ((playerPositions[currentPlayer] + 1) % 4 === 0) {
                isTrapped[currentPlayer] = true;
                const [num1, num2] = [Math.floor(Math.random() * 900) + 100, Math.floor(Math.random() * 90) + 10];
                const answer = prompt(`Solve this to continue: ${num1} x ${num2} = ?`);
                if (parseInt(answer) !== num1 * num2) {
                    alert('Wrong answer! You cannot move forward.');
                } else {
                    isTrapped[currentPlayer] = false;
                }
            }
            switchPlayer();
        }

        function switchPlayer() {
            currentPlayer = (currentPlayer + 1) % numPlayers;
        }

        function updatePlayerPosition() {
            cells.forEach(cell => {
                cell.innerHTML = cell.innerHTML.replace('<div class="player player1"></div>', '');
                cell.innerHTML = cell.innerHTML.replace('<div class="player player2"></div>', '');
            });
            cells[playerPositions[0]].innerHTML += '<div class="player player1"></div>';
            if (numPlayers > 1) {
                cells[playerPositions[1]].innerHTML += '<div class="player player2"></div>';
            }
        }
    </script>
</body>
</html>